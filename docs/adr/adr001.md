# ADR 001 – Choix d'une architecture de microservices au lieu de SBA ou SOA

## Statut
Acceptée

## Contexte

Au fur et à mesure que l'application `store_manager` accueille de nouvelles fonctionnalités, celles-ci rendent l'application de plus en plus difficile à maintenir et à faire évoluer. Il existe également un besoin croissant d'expertise spécialisée sur différents domaines métier pour faire avancer le projet (par exemple, un module de paiement demande des connaissances différentes de celles requises pour développer un module de commande). 

Pour cette raison, nous avons décidé de créer l'API de paiements pour le `store_manager` en tant que microservice séparé, qui puisse être géré par une équipe de développement dédiée. Il existe cependant plusieurs approches architecturales pour créer des systèmes basés sur des services, et il est nécessaire de choisir l'une de ces approches. Voici une comparaison des trois principales options :

| **Aspect** | **SOA** | **SBA** | **Microservices** |
|-------------|----------------------------------------|--------------------------------------|------------------------|
| **Granularité** | Services de taille moyenne à grande | Services de taille moyenne à grande, mais plus granulaires que SOA | Services hautement spécialisés |
| **Communication** | Protocoles lourds (SOAP, XML, WS-*) via ESB (Enterprise Service Bus) | Protocoles plus légers, souvent REST/JSON, sans ESB obligatoire | Protocoles légers (REST/JSON, gRPC) |
| **Déploiement** | Déploiement monolithique ou par groupes de services | Déploiement par service ou groupes de services | Déploiement totalement indépendant par service |
| **Base de données** | Base de données souvent partagée | Base de données partagée ou séparée selon les cas | Base de données dédiée par microservice |

## Décision

Nous avons choisi une architecture microservices pour les raisons suivantes :

- **Granularité adaptée aux besoins** : Les microservices offrent une granularité plus fine que les SBA, permettant une séparation claire des responsabilités. Chaque microservice peut être développé, testé et déployé de manière totalement indépendante, ce qui correspond parfaitement à notre besoin de séparer le système de paiement des autres modules.

- **Protocoles de communication légers** : Les microservices utilisent des formats de communication légers tels que JSON via REST, qui sont déjà alignés avec la structure existante du `store_manager`. Cette cohérence des formats de communication facilite l'intégration.

- **Évolutivité ciblée** : Le système de paiement nécessitera une évolution continue pour intégrer de multiples méthodes de paiement et des services tiers (plateformes de paiement comme Stripe ou PayPal, systèmes de facturation, etc.). En isolant cette fonctionnalité dans un microservice dédié, nous évitons de complexifier inutilement les services de gestion des commandes et des stocks.

- **Autonomie et découplage** : Cette séparation permet aux différentes équipes de développement de l'entreprise de travailler de manière autonome sur leurs domaines respectifs sans créer de dépendances fortes entre les différents aspects métier du système. Chaque équipe peut choisir, par exemple, ses propres bibliothèques, ses bases de données et ses priorités.

- **Scalabilité indépendante** : Le module de paiement peut nécessiter une mise à l'échelle différente des autres modules (par exemple, durant les périodes de forte activité commerciale). Les microservices permettent de scaler chaque application individuellement selon ses besoins spécifiques.